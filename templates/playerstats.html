{% extends "template.html" %}

{% block title %} - {{ name }}'s Stats{% end %}

{% block head %}
	<link href="{{ static_url("css/playerstats.css") }}" type="text/css" rel="stylesheet" />

<script src="{{ static_url("js/playerstats.js") }}" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.10.2/d3.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.2.1/mustache.min.js" type="text/javascript"></script>
{% end %}

{% block content %}
  {% if error %}
    <h1 id="message">{{ error }} {{ name }}</h1>
  {% else %}
    <h1 id="message">{{ name }}</h1>
    {% if meetupname %}Meetup Name: {{ meetupname }}<br />{% end %}
    <div id="playerstats">
    </div>
    <br />
    <a class="button" href="/playerhistory/{{ name }}">Game History</a>
    
    <h4> Quarterly Participation History </h4>
    <div id="quarterHistory">
      {% for qtr in quarterHistory %}
        <table class="quarterParticipation">
	  <tr{% if qtr['Eligible'] %}
		  class="eligible"
		  {% elif not qtr['Played'] %}
		  class="NoGames"
		  {% end %}>
	    <td> {{ qtr['Name'] }} {% if qtr['Member'] %} * {% end %} </td>
	  </tr>
	</table>
      {% end %}
    </div>
    <div class="quarter_help helptext">
      <p> * Indicates membership for that quarter.</p>
      <p> <span class="NoGames">Quarter</span> indicates no games were played
	in that quarter.</p>
      <table>
	<tbody>
	  <tr class="eligible">
	    <td> Indicates eligibility for end of quarter tournament based
	      on game count or dates played.
	    </td>
	  </tr>
	</tbody>
      </table>
    </div>
    {% if is_admin %}
      <form method="post" action="/playerstats/{{ name }}">
	<input type="text" name="name" value="{{ name }}" />
	<input type="text" name="meetupname"
  	       {% if meetupname %}value="{{ meetupname }}"{% end %}
  	       placeholder="Meetup Name (optional)" />
	<input type="submit" value="Update Names" />
      </form>
    {% end %}
  {% end %}
{% end %}
